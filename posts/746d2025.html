<!DOCTYPE html><html class="hide-aside" lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>使用 OSMnx 对城市网络和便利设施进行建模和分析 | 构建低空信息理论与技术知识图谱！</title><meta name="author" content="Xishansnow"><meta name="copyright" content="Xishansnow"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="   【摘 要】OSMnx1 是一个 Python..."><link rel="shortcut icon" href="/vll-pages/img/favi.jpg"><link rel="canonical" href="http://xishansnow.github.io/vll-pages/posts/746d2025.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/vll-pages/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/vll-pages/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '使用 OSMnx 对城市网络和便利设施进行建模和分析',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><link rel="stylesheet" href="/css/custom.css"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/vll-pages/img/favi.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/vll-pages/archives/"><div class="headline">Articles</div><div class="length-num">108</div></a><a href="/vll-pages/tags/"><div class="headline">Tags</div><div class="length-num">88</div></a><a href="/vll-pages/categories/"><div class="headline">Categories</div><div class="length-num">51</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/vll-pages/index.html"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-map"></i><span> 运行概念</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/94508604.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 综合运行概念</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E8%BF%90%E8%A1%8C%E6%A6%82%E5%BF%B5/UTM/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> UTM 运行概念</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E8%BF%90%E8%A1%8C%E6%A6%82%E5%BF%B5/UAM/"><i class="fa-fw fa-solid fa-map"></i><span> UAM 运行概念</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-atom"></i><span> 空域管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/5d2e7a7c.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E7%A9%BA%E5%9F%9F%E7%AE%A1%E7%90%86/%E7%A9%BA%E5%9F%9F%E7%BB%93%E6%9E%84/"><i class="fa-fw fas fa-atom"></i><span> 空域结构</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E7%A9%BA%E5%9F%9F%E7%AE%A1%E7%90%86/%E7%A9%BA%E5%9F%9F%E6%B3%95%E8%A7%84/"><i class="fa-fw fa-solid fa-magnet"></i><span> 空域法规</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E7%A9%BA%E5%9F%9F%E7%AE%A1%E7%90%86/%E7%9B%B8%E5%85%B3%E9%A1%B9%E7%9B%AE/"><i class="fa-fw fas fa-cogs"></i><span> 相关项目</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-atom"></i><span> 任务规划</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/d04ee52a.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E4%BB%BB%E5%8A%A1%E8%A7%84%E5%88%92/%E4%BB%BB%E5%8A%A1%E5%88%86%E9%85%8D/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 任务分配</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E4%BB%BB%E5%8A%A1%E8%A7%84%E5%88%92/%E5%8D%95%E6%9C%BA%E8%A7%84%E5%88%92/"><i class="fa-fw fas fa-atom"></i><span> 单机规划</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E4%BB%BB%E5%8A%A1%E8%A7%84%E5%88%92/%E5%8D%8F%E5%90%8C%E8%A7%84%E5%88%92/"><i class="fa-fw fa-solid fa-magnet"></i><span> 多机规划</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-atom"></i><span> 风险管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/e53d9399.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E5%AE%9A%E6%80%A7%E8%AF%84%E4%BC%B0/"><i class="fa-fw fas fa-atom"></i><span> 定性评估</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E5%AE%9A%E9%87%8F%E8%AF%84%E4%BC%B0/"><i class="fa-fw fa-solid fa-magnet"></i><span> 定量评估</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E7%BB%93%E6%9E%9C%E5%BA%94%E7%94%A8/"><i class="fa-fw fas fa-cogs"></i><span> 结果应用</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E7%9B%B8%E5%85%B3%E9%A1%B9%E7%9B%AE/"><i class="fa-fw fas fa-cogs"></i><span> 相关项目</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 冲突管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/d805a213.html"><i class="fa-fw fas fa-cogs"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/%E6%88%98%E7%95%A5%E5%B1%82/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 战略层</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/%E6%88%98%E6%9C%AF%E5%B1%82/"><i class="fa-fw fa-solid fa-magnet"></i><span> 战术层</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/DAA/"><i class="fa-fw fa-solid fa-magnet"></i><span> DAA</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/%E9%98%B2%E6%92%9E/"><i class="fa-fw fa-solid fa-magnet"></i><span> 防撞</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-ghost"></i><span> DCB 管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/337b7ab7.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/%E9%9C%80%E6%B1%82%E7%94%9F%E6%88%90/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 需求生成</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/%E9%9C%80%E6%B1%82%E9%A2%84%E6%B5%8B/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 需求预测</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/%E5%AE%B9%E9%87%8F%E8%AF%84%E4%BC%B0/"><i class="fa-fw fas fa-atom"></i><span> 容量评估</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/DCB%E6%8E%AA%E6%96%BD/"><i class="fa-fw fas fa-school"></i><span> DCB 措施</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 其他</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E7%9B%91%E8%A7%86/"><i class="fa-fw fas fa-cogs"></i><span> 监视</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E9%80%9A%E4%BF%A1/"><i class="fa-fw fas fa-cogs"></i><span> 通信</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E5%AF%BC%E8%88%AA/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 定位导航</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E5%BE%AE%E6%B0%94%E8%B1%A1/"><i class="fa-fw fa-solid fa-magnet"></i><span> 微气象</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E8%B5%B7%E9%99%8D%E5%9C%BA/"><i class="fa-fw fas fa-cogs"></i><span> 起降场</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%9E%E8%A1%8C%E5%99%A8/UAS/"><i class="fa-fw fas fa-cogs"></i><span> 飞行器</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E8%BD%AF%E4%BB%B6%E5%B9%B3%E5%8F%B0/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 软件平台</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-compass"></i><span> 关于</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 时间索引</span></a></li><li><a class="site-page child" href="/vll-pages/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签索引</span></a></li><li><a class="site-page child" href="/vll-pages/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类索引</span></a></li><li><a class="site-page child" href="/vll-pages/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/book_19.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/vll-pages/"><span class="site-name">构建低空信息理论与技术知识图谱！</span></a><a class="nav-page-title" href="/vll-pages/"><span class="site-name">使用 OSMnx 对城市网络和便利设施进行建模和分析</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/vll-pages/index.html"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-map"></i><span> 运行概念</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/94508604.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 综合运行概念</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E8%BF%90%E8%A1%8C%E6%A6%82%E5%BF%B5/UTM/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> UTM 运行概念</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E8%BF%90%E8%A1%8C%E6%A6%82%E5%BF%B5/UAM/"><i class="fa-fw fa-solid fa-map"></i><span> UAM 运行概念</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-atom"></i><span> 空域管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/5d2e7a7c.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E7%A9%BA%E5%9F%9F%E7%AE%A1%E7%90%86/%E7%A9%BA%E5%9F%9F%E7%BB%93%E6%9E%84/"><i class="fa-fw fas fa-atom"></i><span> 空域结构</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E7%A9%BA%E5%9F%9F%E7%AE%A1%E7%90%86/%E7%A9%BA%E5%9F%9F%E6%B3%95%E8%A7%84/"><i class="fa-fw fa-solid fa-magnet"></i><span> 空域法规</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E7%A9%BA%E5%9F%9F%E7%AE%A1%E7%90%86/%E7%9B%B8%E5%85%B3%E9%A1%B9%E7%9B%AE/"><i class="fa-fw fas fa-cogs"></i><span> 相关项目</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-atom"></i><span> 任务规划</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/d04ee52a.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E4%BB%BB%E5%8A%A1%E8%A7%84%E5%88%92/%E4%BB%BB%E5%8A%A1%E5%88%86%E9%85%8D/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 任务分配</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E4%BB%BB%E5%8A%A1%E8%A7%84%E5%88%92/%E5%8D%95%E6%9C%BA%E8%A7%84%E5%88%92/"><i class="fa-fw fas fa-atom"></i><span> 单机规划</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E4%BB%BB%E5%8A%A1%E8%A7%84%E5%88%92/%E5%8D%8F%E5%90%8C%E8%A7%84%E5%88%92/"><i class="fa-fw fa-solid fa-magnet"></i><span> 多机规划</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-atom"></i><span> 风险管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/e53d9399.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E5%AE%9A%E6%80%A7%E8%AF%84%E4%BC%B0/"><i class="fa-fw fas fa-atom"></i><span> 定性评估</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E5%AE%9A%E9%87%8F%E8%AF%84%E4%BC%B0/"><i class="fa-fw fa-solid fa-magnet"></i><span> 定量评估</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E7%BB%93%E6%9E%9C%E5%BA%94%E7%94%A8/"><i class="fa-fw fas fa-cogs"></i><span> 结果应用</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%8E%E9%99%A9%E5%88%86%E6%9E%90/%E7%9B%B8%E5%85%B3%E9%A1%B9%E7%9B%AE/"><i class="fa-fw fas fa-cogs"></i><span> 相关项目</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 冲突管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/d805a213.html"><i class="fa-fw fas fa-cogs"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/%E6%88%98%E7%95%A5%E5%B1%82/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 战略层</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/%E6%88%98%E6%9C%AF%E5%B1%82/"><i class="fa-fw fa-solid fa-magnet"></i><span> 战术层</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/DAA/"><i class="fa-fw fa-solid fa-magnet"></i><span> DAA</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%86%B2%E7%AA%81%E7%AE%A1%E7%90%86/%E9%98%B2%E6%92%9E/"><i class="fa-fw fa-solid fa-magnet"></i><span> 防撞</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-ghost"></i><span> DCB 管理</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/posts/337b7ab7.html"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 索引帖</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/%E9%9C%80%E6%B1%82%E7%94%9F%E6%88%90/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 需求生成</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/%E9%9C%80%E6%B1%82%E9%A2%84%E6%B5%8B/"><i class="fa-fw fa-solid fa-pen-nib"></i><span> 需求预测</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/%E5%AE%B9%E9%87%8F%E8%AF%84%E4%BC%B0/"><i class="fa-fw fas fa-atom"></i><span> 容量评估</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%9C%80%E6%B1%82%E5%AE%B9%E9%87%8F%E5%B9%B3%E8%A1%A1/DCB%E6%8E%AA%E6%96%BD/"><i class="fa-fw fas fa-school"></i><span> DCB 措施</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-compass"></i><span> 其他</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E7%9B%91%E8%A7%86/"><i class="fa-fw fas fa-cogs"></i><span> 监视</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E9%80%9A%E4%BF%A1/"><i class="fa-fw fas fa-cogs"></i><span> 通信</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E5%AF%BC%E8%88%AA/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 定位导航</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E5%BE%AE%E6%B0%94%E8%B1%A1/"><i class="fa-fw fa-solid fa-magnet"></i><span> 微气象</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD/%E8%B5%B7%E9%99%8D%E5%9C%BA/"><i class="fa-fw fas fa-cogs"></i><span> 起降场</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E9%A3%9E%E8%A1%8C%E5%99%A8/UAS/"><i class="fa-fw fas fa-cogs"></i><span> 飞行器</span></a></li><li><a class="site-page child" href="/vll-pages/categories/%E8%BD%AF%E4%BB%B6%E5%B9%B3%E5%8F%B0/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/"><i class="fa-fw fa-solid fa-layer-group"></i><span> 软件平台</span></a></li></ul></div><div class="menus_item"><span class="site-page group hide"><i class="fa-fw fas fa-compass"></i><span> 关于</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/vll-pages/archives/"><i class="fa-fw fa-solid fa-timeline"></i><span> 时间索引</span></a></li><li><a class="site-page child" href="/vll-pages/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签索引</span></a></li><li><a class="site-page child" href="/vll-pages/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类索引</span></a></li><li><a class="site-page child" href="/vll-pages/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li></ul></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">使用 OSMnx 对城市网络和便利设施进行建模和分析</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-01-10T04:00:00.000Z" title="Created 2025-01-10 12:00:00">2025-01-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-01-17T11:30:32.505Z" title="Updated 2025-01-17 19:30:32">2025-01-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/vll-pages/categories/%E8%BD%AF%E4%BB%B6%E5%B9%B3%E5%8F%B0/">软件平台</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/vll-pages/categories/%E8%BD%AF%E4%BB%B6%E5%B9%B3%E5%8F%B0/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/">开源软件</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">8.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>30mins</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><script src='https://unpkg.com/tippy.js@2.0.2/dist/tippy.all.min.js'></script>
<script src='/js/attachTooltips.js'></script>
<link rel='stylesheet' href='/css/tippy.css'>
<p>【摘 要】OSMnx<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> 是一个 Python 包，用于从
OpenStreetMap
数据中下载、建模、处理、分析和可视化城市网络和任何其他地理空间特征。越来越多的文献使用它来进行地理、城市规划、交通工程、计算机科学等学科的科学研究。OSMnx
项目最近开发并实现了许多新功能、建模功能和分析方法。该包现在包含的功能比文献中以前记录的要多得多。因此，本文介绍了
OSMnx
包的新功能、用法和设计，以及它们背后的科学理论和逻辑。最后，它反思了地理信息科学中的工具构建以及对开放科学模式下城市建模和分析的影响。</p>
<p>【原 文】 Boeing, G. (2024) ‘Modeling and analyzing urban networks
and amenities with osmnx’.</p>
<p>【参考资料】无</p>
<style>p{text-indent:2em}</style>
<h1 id="引言">引言</h1>
<p>对网络化城市基础设施（如街道、铁路、运河等）和地理空间特征（如便利设施、兴趣点等）进行建模，是研究出行行为、可达性、公共卫生、可持续性和空间公平性的基础。这项研究涵盖城市形态学 [<a
href="#ref-coutrot2022a">21</a>, <a href="#ref-gervasoni2017a">30</a>,
<a href="#ref-nilsson2019a">42</a>]、交通规划 [<a
href="#ref-liao2020a">34</a>, <a href="#ref-merch2020a">38</a>, <a
href="#ref-natera2020a">40</a>]和网络科学 [<a
href="#ref-feng2020a">25</a>, <a href="#ref-yin2020a">56</a>, <a
href="#ref-yin2020a">56</a>]等学科。但数据可用性的传统限制、不一致的数字化标准以及缺乏有据可查的可重复使用的工具，历来限制了实证城市网络建模的可重复性、通用性、可扩展性和实用性 [<a
href="#ref-liu2022a">35</a>]。为了应对许多学科面临的类似挑战，开放科学运动呼吁可重复性和透明度——特别是通过构建、共享和利用开源分析工具 [<a
href="#ref-kedron2021a">33</a>, <a href="#ref-rey2009a">47</a>, <a
href="#ref-rey2019a">48</a>, <a
href="#ref-singleton2016a">51</a>]。与各学科的同行一样，城市研究人员需要好的工具来进行好的科学研究。</p>
<p>本文介绍了 OSMnx，这是一个 Python
包，允许用户轻松下载、建模、分析和可视化来自 OpenStreetMap
数据的城市网络和地理空间特征。用户只需一行代码即可下载和建模步行、驾驶、骑自行车或自定义网络，然后对其进行分析和可视化。用户可以轻松处理城市设施和兴趣点、建筑物足迹、公交站、海拔数据、街道方向、速度和行程时间以及路线。</p>
<p>OSMnx 软件包于 2016 年首次以测试版发布，早期版本记录在初步论文 [<a
href="#ref-boeing2017a">12</a>]中。当时，它是第一个使用户能够自动下载和建模世界上任何城市的街道网络几何和拓扑结构以图模型形式进行分析和可视化的工具 [<a
href="#ref-boeing2020b">15</a>]。此后几年，它已成为广泛用于城市建模和分析的工具 [<a
href="#ref-coutrot2022a">21</a>, <a href="#ref-feng2020a">25</a>, <a
href="#ref-gervasoni2017a">30</a>, <a href="#ref-liao2020a">34</a>, <a
href="#ref-natera2020a">40</a>, <a href="#ref-nilsson2019a">42</a>, <a
href="#ref-yin2020a">56</a>, <a href="#ref-yin2020a">56</a>]。</p>
<p>但自首次发布以来，该软件包通过扩展其功能、提高性能和稳定用户友好的
API
得到了很大的发展。为了记录这些最先进的功能及其在文献中的科学基础，本文介绍了
OSMnx
当前的模块化结构、功能和城市建模和分析用途。下一节介绍了街道网络建模和分析的理论、数据和工具，包括
OSMnx 在该领域的地位。然后介绍 OSMnx
软件包的功能、组织和用法。最后，本文简要讨论了它对地理信息科学中城市网络分析和工具构建的影响。</p>
<h1 id="街道网络模型及分析">街道网络模型及分析</h1>
<p>众多资料涵盖了空间网络理论和分析 [<a href="#ref-barnes1983a">1</a>,
<a href="#ref-barthelemy2011a">8</a>, <a
href="#ref-ducruet2014a">23</a>, <a href="#ref-gastner2006a">29</a>, <a
href="#ref-marshall2018a">37</a>, <a href="#ref-osullivan2014a">43</a>,
<a
href="#ref-tinkler1979a">53</a>]。本节重点介绍街道网络，并概述必要的概念，然后简要回顾当前的工具概况。</p>
<h2 id="模型基础">模型基础</h2>
<p>现实世界中的网络通常被建模为数学图 [<a
href="#ref-barthelemy2022a">9</a>, <a
href="#ref-trudeau1994a">54</a>]。图 <span
class="math inline">\(G\)</span> 是一种数据结构，由两组组成：一组 <span
class="math inline">\(N\)</span> 包含通过第二组 <span
class="math inline">\(E\)</span>
相互链接的节点，后者包含称为边的节点对。设 <span
class="math inline">\(G=(N, E)\)</span> 和 <span
class="math inline">\(\{u, v \}\subseteq N\)</span> 和 <span
class="math inline">\(\{u, v \}\in E\)</span>。对于图 <span
class="math inline">\(G\)</span> ，我们可以说：</p>
<p>1） 边 <span class="math inline">\(\{u, v \}\)</span> 链接节点 <span
class="math inline">\(u\)</span> 和 <span
class="math inline">\(v\)</span>；</p>
<p>2）边 <span class="math inline">\(\{u, v\}\)</span> 与节点 <span
class="math inline">\(u\)</span> 和 <span
class="math inline">\(v\)</span> 相邻；</p>
<p>3）节点 <span class="math inline">\(u\)</span> 与 <span
class="math inline">\(v\)</span> 相邻，反之亦然；</p>
<p>4）节点 <span class="math inline">\(u\)</span> 和 <span
class="math inline">\(v\)</span> 是邻居  [<a
href="#ref-newman2010a">41</a>]。邻接矩阵可以通过定义这些相邻节点对来完整地表示图。</p>
<p>节点的度是指与该节点关联的边数。例如，度为 2
的节点有两条关联边，因此它们彼此相邻。边可以是无向的（双向连接两个节点）、有向的（从源节点单向连接到目标节点）或自循环的（将一个节点链接回自身）。具有有向边的图是有向图或有向图。允许多条边连接一对节点的图是多重图，这些多条边称为平行边。</p>
<p>路径是连接一系列节点的一系列边。两个节点之间的图距离是它们之间最短路径的边数。加权图的距离是沿最短路径的一些边阻抗属性（例如长度或时间）的总和，以使该总和最小化。如果每对有序节点之间存在路径，则有向图是强连通的，如果只有其边无向时才存在这样的路径，则有向图是弱连通的。断开图包含多个连通组件
- 每个组件都是一组不相交的节点，形成自己的连通子图。</p>
<p>空间网络的节点和/或边嵌入空间 [<a
href="#ref-barthelemy2022a">9</a>]。因此，空间图同时模拟拓扑和几何 [<a
href="#ref-osullivan2014a">43</a>]。拓扑是指节点和边的结构和配置，而几何则包括位置、长度、角度等。平面图的拓扑可以在二维平面中表示，使得其边仅在节点处相交 [<a
href="#ref-barthelemy2008a">11</a>]。由于偶尔存在立交桥和地下通道，大多数街道网络都是非平面的，但它们的空间嵌入和
“近似” 平面性限制了它们相对于其他类型的复杂网络的拓扑特征 [<a
href="#ref-boeing2020a">14</a>]。原始图将街道网络的交叉点和死胡同建模为节点，将其街道段建模为边 [<a
href="#ref-porta2006b">45</a>]。对偶图（有时称为线图）将此拓扑结构反转，将街道建模为节点，将其交叉点建模为边 [<a
href="#ref-porta2006a">44</a>]，尽管它丢弃了网络的大部分几何形状 [<a
href="#ref-ratti2004a">46</a>]。</p>
<h2 id="街道网络分析">街道网络分析</h2>
<p>许多常见的空间网络几何测量方法通常应用于街道网络。一般来说，这些方法应使用无向图表示，以避免相对于单向街道重复计算双向街道。交叉口密度（即，按网络面积归一化的度为
<span class="math inline">\(&gt;1\)</span>
的节点数）可能是交通规划和城市设计中最常见的网络 “粒度” 测量方法 [<a
href="#ref-ewing2010a">24</a>]。平均街道段长度（即平均边长）提供了街区大小的线性代理。街道密度是按网络面积归一化的边长总和。迂回度可以有不同的解释，包括平均迂回度：边长总和除以相邻节点对之间的大圆距离总和，表示网络边直线度的倒数 [<a
href="#ref-boeing2019a">13</a>]。</p>
<p>此外，网络科学中的许多拓扑度量通常应用于街道网络 [<a
href="#ref-barthelemy2011a">8</a>]。平均节点度（即与节点相关的边的平均数）表示图的连通性
<a href="#fn2" class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a>，可能是交通规划和城市设计中最常见的拓扑度量 [<a
href="#ref-barrington-leigh2015a">3</a>–<a
href="#ref-barrington-leigh2020a">5</a>]。连通性高的网络可以更有效地抵抗干扰，因为如果网络的某些部分发生故障，它们可以提供替代路由选项 [<a
href="#ref-boeing2024a">18</a>]。各种中心性度量也很常见 [<a
href="#ref-crucitti2006a">22</a>]。例如，节点的中介中心性度量通过该节点的所有图最短路径的份额 [<a
href="#ref-barthelemy2004a">7</a>, <a
href="#ref-barthelemy2013a">10</a>]。图的最大中介中心性表示依赖于其最重要节点的最短路径的份额：高值表示可能的瓶颈，代表单点故障，例如连接城市两半的桥梁 [<a
href="#ref-boeing2024b">19</a>]。</p>
<p>在街道网络分析中，研究人员使用这些几何和拓扑度量来表征网络的形式。此类分析通常还采用路径求解 [<a
href="#ref-miller1999a">39</a>, <a
href="#ref-wang2020a">55</a>]。例如，可达性分析求解从起点节点（例如住宅）到代表便利设施位置（例如工作场所、学校、公交站、公园、蔬菜水果店、医院等）的目的节点的最短路径（例如按长度或行程时间）来测量可达性 [<a
href="#ref-foti2014a">27</a>, <a
href="#ref-liu2022a">35</a>]。灾害分析通常会模拟网络沿线的紧急响应或疏散，以了解灾害后的流量 [<a
href="#ref-sasabe2020a">50</a>, <a
href="#ref-tamakloe2021a">52</a>]。这些类型的分析可以揭示城市中不同社区或地点的不同结果，为从业者的干预提供指导。</p>
<h2 id="街道网络工具和数据">街道网络工具和数据</h2>
<p>存在各种工具来建模和分析空间网络（如街道网络）。例如，ESRI 的 ArcGIS
软件包含 Network Analyst 扩展，而 QGIS 提供用于网络分析的插件。但此类
GIS 工具的网络功能通常相当有限。相反，专用的网络分析工具（如
Gephi、igraph、graph-tool 和
NetworkX）提供强大的网络分析功能，但地理空间功能有限。还有其他专用的空间网络工具，通常用于特定的分析目的，包括用于网络推断的
PySAL spaghetti [<a href="#ref-gaboardi2021a">28</a>, <a
href="#ref-rey2022a">49</a>]、用于可达性分析的 Pandana [<a
href="#ref-foti2014a">27</a>]、用于城市形态的 momepy [<a
href="#ref-fleischmann2019a">26</a>]和用于交通规划的 stplanr [<a
href="#ref-lovelace2019a">36</a>]。</p>
<p>街道网络数据有多种来源，包括政府来源，如美国人口普查局的 TIGER/Line
形文件，它们表示网络几何形状，但缺乏足够的拓扑信息来构建适当的非平面模型。另外，OpenStreetMap
提供了一个全球性的公共网络地图平台和地理空间数据库，任何人都可以参与其中，并接受一些编辑监督，其中包括街道、高速公路、公交、建筑物、人行道、自行车道、兴趣点和政治边界 [<a
href="#ref-jokar2015a">32</a>]。虽然其覆盖范围各不相同，但它包括网络几何和拓扑，其数据质量通常很高，特别是在城市地区，但中国和撒哈拉以南非洲地区也有明显的例外 [<a
href="#ref-barrington-leigh2017b">2</a>, <a
href="#ref-barron2014a">6</a>]。OpenStreetMap
的数据模型包含三种元素类型：节点（点）、道路（表示线的开放道路或表示多边形的封闭道路）和关系（即节点和/或道路之间的关系）。这些元素可以拥有一个或多个标签：包含属性数据的键值对。可以从第三方服务（例如
Geofabrik）和 Web API（包括 Overpass 和 Nominatim）下载 OpenStreetMap
数据。</p>
<p>但问题在于，从原始的 OpenStreetMap 数据构建街道网络模型相当困难。使用
Overpass API
提取正确的数据来构建合适的图模型可能很麻烦。分析师通常必须编写大量临时代码来将原始数据处理成有用的图模型模型，然后编写更多代码进行分析。他们关于如何处理无处不在的街道网络特征（例如有向性、平面性、自循环、平行边或死胡同）的决定通常没有记录。由于每个研究团队都编写自己的临时代码，因此无数小的建模决策不可避免地不会在最终的同行评审文献中报告——但这些小决策加起来会严重限制可解释性和可复制性。</p>
<p>OSMnx 适合这种环境，它允许用户通过自动从 OpenStreetMap
下载原始数据并使用空间信息构建 NetworkX
模型，在世界任何地方构建空间网络模型。这使用户可以避开临时编码，用一个有据可查且透明的通用工具取代许多小的建模决策。因此，OSMnx
已成为文献中的标准工具，既可用于广泛检索 OpenStreetMap
数据，也可用于专门建模街道网络 [<a
href="#ref-boeing2020b">15</a>]。以下部分提供了当前 <a href="#fn3"
class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a>。包的组织、功能和用法的介绍。</p>
<h1 id="osmnx-包">OSMnx 包</h1>
<p>OSMnx（发音为首字母缩写： “oh-ess-em-en-ex”
）是一个免费的、开源的、完全类型提示的纯 Python
包。该包的结构是组织相关功能的模块集合（表<a href="#tab:tab1"
data-reference-type="ref" data-reference="tab:tab1">8</a>）。它建立在
NetworkX [<a href="#ref-hagberg2008a">31</a>]（一个网络分析 Python
包）和 GeoPandas [<a
href="#ref-bossche2024a">20</a>]（一个用于处理地理空间数据框的 Python
包）之上，并使用它们的数据结构。它与三个公共 Web API
交互以收集数据：OpenStreetMap Nominatim API、Overpass API 和 Google Maps
Elevation API（或具有相同接口的等效 API）。本节介绍 OSMnx
的组织和功能。</p>
<h2 id="地理编码和查询">地理编码和查询</h2>
<p>OSMnx 使用 Nominatim API
对地名和地址进行地理编码。用户可以使用地理编码器模块将地名或地址地理编码为经纬度点坐标。或者，他们可以通过名称或
ID 检索地点边界或任何其他 OpenStreetMap
元素。使用如下所述的功能和图模型模块，用户可以通过经纬度点坐标、地址、边界框、边界多边形/多多边形或地名（例如街区、城市、县等）从
Overpass API 下载 OpenStreetMap 数据。</p>
<h2 id="城市设施">城市设施</h2>
<p>使用 OSMnx 的功能模块，用户可以从 OpenStreetMap Overpass API
搜索和下载任何地理空间功能设施（例如，建筑物占地面积、杂货店、学校、公园、公交站等）作为
GeoPandas GeoDataFrame 对象。这使用 OpenStreetMap
标签来搜索匹配的元素。</p>
<h2 id="网络的建模">网络的建模</h2>
<p>OSMnx 将空间网络建模为原始、非平面、加权、有向多重图，可能具有自循环
- 具体来说，这些是 NetworkX MultiDiGraph 数据结构 [<a
href="#ref-hagberg2008a">31</a>]。使用 OSMnx 的图模型模块，用户可以从
Overpass API
下载任何空间网络数据（例如街道、路径、铁路、运河、电力线等）并将其建模为
MultiDiGraph。</p>
<p>OSMnx 将单行道建模为从节点 <span class="math inline">\(u\)</span>
到节点 <span class="math inline">\(v\)</span>
的单向边，但双向街道则用两条互向边（具有相同的几何形状）建模——一个从
<span class="math inline">\(u\)</span> 到 <span
class="math inline">\(v\)</span> ，另一个从 <span
class="math inline">\(v\)</span> 到 <span
class="math inline">\(u\)</span> -
以表示两种可能的流动方向。由于这些图是非平面的，因此它们正确地模拟了立交桥、天桥和地下通道的拓扑结构。也就是说，二维平面中的边交叉点不是
OSMnx 模型中的节点，除非它们代表三维现实世界中的真正交汇点。</p>
<div class="scriptsize">
<div class="center">
<div id="tab:tab1">
<table>
<caption>OSMnx 公共 APl 的模块及其公开的功能。</caption>
<thead>
<tr>
<th style="text-align: left;">Module</th>
<th style="text-align: left;">Functionality</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">bearing</td>
<td style="text-align: left;">Calculate graph edge compass bearings and
orientation entropy.</td>
</tr>
<tr>
<td style="text-align: left;">convert</td>
<td style="text-align: left;">Convert graph to/from different data
types.</td>
</tr>
<tr>
<td style="text-align: left;">distance</td>
<td style="text-align: left;">Calculate spatial distances and find
nearest graph node/edge(s) to point(s).</td>
</tr>
<tr>
<td style="text-align: left;">elevation</td>
<td style="text-align: left;">Attach node elevations from raster files
or a Google Maps compatible elevation API, and calculate edge
grades.</td>
</tr>
<tr>
<td style="text-align: left;">features</td>
<td style="text-align: left;">Download OSM geospatial features’
geometries and attributes, such as points of interest, building
footprints, transit stops, etc.</td>
</tr>
<tr>
<td style="text-align: left;">geocoder</td>
<td style="text-align: left;">Geocode place names or addresses or
retrieve OSM elements by place name or ID, via the Nominatim API.</td>
</tr>
<tr>
<td style="text-align: left;">graph</td>
<td style="text-align: left;">Download and create graphs from OSM data,
using filters to query the Overpass API for built-in network types or a
custom filter.</td>
</tr>
<tr>
<td style="text-align: left;">io</td>
<td style="text-align: left;">Save/load graphs to/from GraphML,
GeoPackage, or OSM XML files.</td>
</tr>
<tr>
<td style="text-align: left;">plot</td>
<td style="text-align: left;">Visualize street networks, routes,
orientations, and geospatial features.</td>
</tr>
<tr>
<td style="text-align: left;">projection</td>
<td style="text-align: left;">Project spatial graph to a different
coordinate reference system.</td>
</tr>
<tr>
<td style="text-align: left;">routing</td>
<td style="text-align: left;">Calculate graph edge speeds, travel times,
and weighted shortest paths between nodes.</td>
</tr>
<tr>
<td style="text-align: left;">settings</td>
<td style="text-align: left;">Configure global package settings.</td>
</tr>
<tr>
<td style="text-align: left;">simplification</td>
<td style="text-align: left;">Simplify and consolidate spatial graph
nodes and edges.</td>
</tr>
<tr>
<td style="text-align: left;">stats</td>
<td style="text-align: left;">Calculate geometric and topological
network measures.</td>
</tr>
<tr>
<td style="text-align: left;">truncate</td>
<td style="text-align: left;">Truncate spatial graph by distance,
bounding box, or polygon.</td>
</tr>
<tr>
<td style="text-align: left;">utils</td>
<td style="text-align: left;">General utility functions.</td>
</tr>
<tr>
<td style="text-align: left;">utils_geo</td>
<td style="text-align: left;">Miscellaneous geospatial utility
functions.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<figure id="fig:fig1">
<div class="scriptsize">
<div class="center">
<p><img src="https://xishansnowblog.oss-cn-beijing.aliyuncs.com/images/vll/2025_01_10_05a6a3cd1c03e69f69a0g-08.jpg" style="width:75.0%" /></p>
</div>
</div>
<figcaption>
某城镇街道网络边简化前（左）和简化后（右）的图表。
</figcaption>
</figure>
<p>图模型模块使用过滤器来查询 Overpass
API：用户可以指定内置的网络类型，也可以提供用 OverpassQL
编写的自定义过滤器。OSMnx
在后台执行多项运行来生成最佳模型。它最初将查询区域缓冲 200
米以创建初始图模型，然后将其截断为用户所需的查询区域。这通过减弱图模型周长效应来确保准确的每节点街道计数。由于图模型可能包含周长周围的许多小断开组件，因此默认情况下它会返回最大的弱连接组件。OSMnx
还会自动简化图模型拓扑，如下所述。</p>
<h2 id="图模型的简化">图模型的简化</h2>
<p>简化模块自动处理来自原始 OpenStreetMap
数据的网络拓扑，以确保各个节点代表各个交叉路口或死胡同，而边代表连接它们的街道段。此图模型的简化有两种主要类型
- 边简化和节点合并 - 在 [<a
href="#ref-boeing2024a">18</a>]中详细描述并在此处总结。</p>
<p><strong>边简化</strong>：就是合并相邻边以形成更好的模型。它清理了图模型的拓扑结构，以便节点表示交叉点或死胡同，而边表示街道段，如图<a
href="#fig:fig1" data-reference-type="ref"
data-reference="fig:fig1">1</a> 所示。这很重要，因为在 OpenStreetMap
的原始数据中，路线由节点（nodes）之间的直线段集组成：也就是说，节点可以是街道曲线几何中的任意顶点（vertices），而不仅仅是交叉点和死胡同。默认情况下，OSMnx
通过删除非交叉点/死胡同节点、将它们之间的边合并为新的 “简化”
边并保留完整的真实边几何作为边属性来简化此拓扑。当多个 OpenStreetMap
路线合并为新的图模型边时，路线的属性值可以聚合为单个值。</p>
<p><strong>节点合并</strong>：就是合并附近的节点以形成更好的模型。这一点很重要，因为许多现实世界的街道网络都具有复杂的交叉路口和环形交叉路口，从而导致图模型节点集群实际上只有一个真正的交叉路口，就像我们在交通规划或城市设计中考虑的那样。同样，分叉道路通常由单独的中心线边表示。因此，两条分叉道路的交叉路口会创建
4 个节点，其中每条边与一条垂直边相交 - 但这 4
个节点代表现实世界中的单个交叉路口。OSMnx
可以将这种复杂的交叉路口合并为单个节点，并可选择相应地重建图模型的边拓扑。当多个
OpenStreetMap
节点合并到一个新的图模型节点时，节点的属性值可以聚合为单个值。</p>
<p>边简化和节点合并提供了多种好处。它们可以生成更准确的模型，更好地代表现实世界。这反过来又会产生更准确的网络测量值，例如在计算交叉路口密度时不会过度计算复杂的交叉路口，也不会低估街道段长度。最后，许多图算法的时间复杂度会随着节点或边数而变化。通过生成具有（通常大幅）更少节点和边的图（但不损失准确性），许多算法将更快地完成。这在分析大型城市网络时最为重要，因为运行时间会成为问题。</p>
<h2 id="转换投影和保存">转换、投影和保存</h2>
<p>如果用户为了特定分析目的更喜欢网络的无向表示，如背景部分所述，OSMnx
的转换模块可以将 NetworkX MultiDiGraph 模型转换为 NetworkX
MultiGraph。如果用户更喜欢没有任何平行边的有向图，它也可以转换为
NetworkX DiGraph。OSMnx 还可以将 MultiDiGraph 转换为节点和边 GeoPandas
GeoDataFrame 对象。生成的节点 GeoDataFrame 由 OpenStreetMap 节点 ID
索引，生成的边 GeoDataFrame 由端点节点 <span
class="math inline">\(u\)</span>、端点节点 <span
class="math inline">\(v\)</span> 和
<strong>键（用于区分平行边）</strong> 进行多重索引，就像 MultiDiGraph
边由其 <span class="math inline">\(u, v, k e y\)</span>
有序三元组标识一样。这还允许用户将任意节点和边 ShapeFiles 或 GeoPackage
图层加载为 GeoDataFrames，然后将它们转换为 MultiDiGraph
以进行网络分析。</p>
<p>由于这些模型都是空间图，因此它们具有坐标参考系统 (CRS) 元数据。OSMnx
的默认 CRS 是 EPSG:4326，但用户可以使用投影模块将图模型投影到任何其他
CRS。如果用户不确定要投影到哪个 CRS，OSMnx
可以根据图模型节点的质心自动确定适合该运行的通用横轴墨卡托 CRS。</p>
<p>最后，使用 io 模块，用户可以将图模型保存到磁盘作为 GraphML
文件（可以被其他网络分析软件加载，包括 OSMnx）、GeoPackage（可以被其他
GIS 软件加载）或 OSM XML 文件（标准 OpenStreetMap 数据交换格式）。</p>
<h2 id="海拔">海拔</h2>
<p>地形对于理解街道网络形态至关重要，但街道网络分析往往忽略了海拔，因为获取海拔并将其附加到图模型中可能很困难 [<a
href="#ref-boeing2022a">17</a>]。OSMnx
的海拔模块允许用户从局部栅格文件或 Google Maps Elevation API
自动将海拔属性添加到空间图模型的节点。一旦所有节点都具有海拔属性，用户就可以自动计算边
level（即上升斜率）、分析某些街道的陡度，或使用阻抗函数中的海拔变化进行路由，如下所述。</p>
<h2 id="地图匹配与路线规划">地图匹配与路线规划</h2>
<p>OSMnx
提供基本的地图匹配和路线功能。距离模块可以使用快速空间索引和矢量化运行将坐标列表与每个最近的节点或边进行匹配。这对于将坐标的起点-目的地矩阵（例如地理编码地址）转换为相应的最近节点以进行路线求解非常有用。</p>
<p>路由模块可以使用不同的权重（例如距离、行程时间、海拔变化等）求解网络路由的最短路径（通过多处理并行化）。OpenStreetMap
有一个 “maxspeed”
标签，表示街道的最大速度限制，但对于大多数城市来说，这个标签往往很稀疏。为了解决这个问题，路由模块可以根据图中相同类型的其他边的观测值来估算缺失的边最大速度。这种估算可能不精确，但用户可以通过传递每种类型的局部速度限制来覆盖它。一旦所有边都具有最大速度属性，模块还可以自动计算每条边的自由流动遍历时间。</p>
<h2 id="网络措施">网络措施</h2>
<p>统计模块可以计算网络的各种几何和拓扑测量值 [<a
href="#ref-boeing2022a">17</a>]。这些测量值将街道定义为图模型无向表示中的边，以防止重复计算双向街道的双向边。用户可以自动计算交通规划、城市设计和网络科学中的常见测量值，包括交叉口密度、迂回度、平均节点度、中心性等。用户还可以直接使用
NetworkX 计算数十种其他拓扑网络测量值。此外，OSMnx
的方位模块可以计算街道的罗盘方位和网络的方向熵 [<a
href="#ref-boeing2019a">13</a>]。</p>
<h2 id="可视化">可视化</h2>
<p>用户可以使用 OSMnx 的绘图模块可视化网络特征、路线、网络图底图 [<a
href="#ref-boeing2021a">16</a>]、建筑物覆盖区和网络方向极坐标直方图 [<a
href="#ref-boeing2019a">13</a>]。用户还可以轻松地以交互式网络地图的形式探索网络、路线或城市设施。</p>
<h2 id="安装和配置">安装和配置</h2>
<p>OSMnx 项目的源代码 <a href="#fn4" class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a>公开托管在 GitHub 上。用户可以使用
pip 从 PyPI 软件包存储库安装软件包，也可以使用 conda 从 Anaconda
软件包存储库安装软件包，详情请参阅软件包文档 <a href="#fn5"
class="footnote-ref" id="fnref5"
role="doc-noteref"><sup>5</sup></a>及其安装说明。要开始使用，用户可以阅读文档的入门指南，然后浏览
OSMnx 示例库 <a href="#fn6" class="footnote-ref" id="fnref6"
role="doc-noteref"><sup>6</sup></a>，获取分步教程、功能演示和示例代码。</p>
<p>安装并导入后，用户可以通过其设置模块配置
OSMnx。在这里，他们可以调整日志记录行为、服务器响应缓存、服务器端点（包括指向局部托管实例）等等。用户还可以配置
OSMnx 以检索截至特定日期的 OpenStreetMap 数据的历史快照。</p>
<h1 id="讨论">讨论</h1>
<p>开放科学运动呼吁使用可访问、可重复使用且有据可查的研究工具来支持更好的科学研究。OSMnx
项目旨在通过提供这样的工具来从 OpenStreetMap
数据对世界各地的城市网络和设施进行建模和分析，从而为城市科学的这些目标做出贡献。它以易于使用的工具体现了城市规划、网络科学和地理信息科学的相关领域理论。反过来，研究人员不再需要重新发明轮子并为每个分析项目做出数十个临时建模决策。</p>
<p>按照这些思路，OSMnx
项目旨在通过允许用户自动建模具有明确定义的空间范围、详尽记录的建模决策和理论上复杂的结果的网络来提高可重复性。例如，它的图模型是原始的、非平面的、有向的、加权的、具有可能的自循环的多重图，以捕捉世界各地网络类型和特征的多样性。它的图模型创建方法可以减弱边界效应，它的图模型的简化方法可以生成灵活地匹配现实世界期望和使用的模型。</p>
<p>本文记录了该软件包的当前组织、功能和科学基础。由学术领域专家领导的更好的工具是实现更好、更开放的科学的关键途径之一。</p>
<h1 class="unnumbered" id="致谢">致谢</h1>
<p>作者要感谢 OSMnx
所依赖的许多其他软件包的开发人员和维护人员，以及多年来为 OSMnx
代码库贡献代码、提供时间和专业知识的贡献者。</p>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0"
role="list">
<div id="ref-barnes1983a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1]</div><div class="csl-right-inline">J.
A. Barnes and F. Harary. 1983. Graph theory in network analysis.
<em>Social Networks</em> 5, 2 (1983), 235–244.</div>
</div>
<div id="ref-barrington-leigh2017b" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2]</div><div class="csl-right-inline">C.
Barrington-Leigh and A. Millard-Ball. 2017b. The world’s user-generated
road map is more than 80 % complete. <em>PLOS ONE</em> 12(8):eor80698,
(2017b).</div>
</div>
<div id="ref-barrington-leigh2015a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3]</div><div class="csl-right-inline">C.
Barrington-Leigh and A. Millard-Ball. 2015. A century of sprawl in the
united states. <em>Proceedings of the National Academy of Sciences</em>
112, 27 (2015), 8244–8249.</div>
</div>
<div id="ref-barrington-leigh2017a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4]</div><div class="csl-right-inline">C.
Barrington-Leigh and A. Millard-Ball. 2017. More connected urban roads
reduce US GHG emissions. <em>Environmental Research Letters</em> 12, 4
(2017).</div>
</div>
<div id="ref-barrington-leigh2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[5]</div><div class="csl-right-inline">C.
Barrington-Leigh and A. Millard-Ball. 2020. Global trends toward urban
streetnetwork sprawl. <em>Proceedings of the National Academy of
Sciences</em> 117, 4 (2020).</div>
</div>
<div id="ref-barron2014a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[6]</div><div class="csl-right-inline">C.
Barron, P. Neis, and A. Zipf. 2014. A comprehensive framework for
intrinsic OpenStreetMap quality analysis. <em>Transactions in GIS</em>
18, 6 (2014), 877–895.</div>
</div>
<div id="ref-barthelemy2004a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[7]</div><div class="csl-right-inline">M.
Barthelemy. 2004. Betweenness centrality in large complex networks.
<em>The European Physical Journal B: Condensed Matter and Complex
Systems</em> 38, 2 (2004), 163–168.</div>
</div>
<div id="ref-barthelemy2011a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[8]</div><div class="csl-right-inline">M.
Barthelemy. 2011. Spatial networks. <em>Physics Reports</em> 499, I-3
(2011).</div>
</div>
<div id="ref-barthelemy2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[9]</div><div class="csl-right-inline">M.
Barthelemy. 2022. <em>Spatial networks: A complete introduction</em>.
Springer International, Cham.</div>
</div>
<div id="ref-barthelemy2013a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[10]</div><div class="csl-right-inline">M.
Barthelemy, P. Bordin, H. Berestycki, and M. Gribaudi. 2013.
Self-organization versus top-down planning in the evolution of a city.
<em>Scientific Reports</em> 3, (2013).</div>
</div>
<div id="ref-barthelemy2008a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[11]</div><div class="csl-right-inline">M.
Barthelemy and A. Flammini. 2008. Modeling urban street patterns.
<em>Physical Review Letters</em> ioo(13, (2008).</div>
</div>
<div id="ref-boeing2017a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[12]</div><div class="csl-right-inline">G.
Boeing. 2017. OSMnx: New methods for acquiring, constructing, analyzing,
and visualizing complex street networks. <em>Computers, Environment and
Urban Systems</em> 65, (2017), 126–139.</div>
</div>
<div id="ref-boeing2019a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[13]</div><div class="csl-right-inline">G.
Boeing. 2019. Urban spatial order: Street network orientation,
configuration, and entropy. <em>Applied Network Science</em> 4, I
(2019).</div>
</div>
<div id="ref-boeing2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[14]</div><div class="csl-right-inline">G.
Boeing. 2020. Planarity and street network representation in urban form
analysis. <em>Environment and Planning B: Urban Analytics and City
Science</em> 47, 5 (2020).</div>
</div>
<div id="ref-boeing2020b" class="csl-entry" role="listitem">
<div class="csl-left-margin">[15]</div><div class="csl-right-inline">G.
Boeing. 2020. The right tools for the job: The case for spatial science
ToolBuilding. <em>Transactions in GIS</em> 24, 5 (2020),
1299–1314.</div>
</div>
<div id="ref-boeing2021a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[16]</div><div class="csl-right-inline">G.
Boeing. 2021. Spatial information and the legibility of urban form: Big
data in urban morphology. <em>International Journal of Information
Management</em> 56, 102013 (2021).</div>
</div>
<div id="ref-boeing2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[17]</div><div class="csl-right-inline">G.
Boeing. 2022. Street network models and indicators for every urban area
in the world. <em>Geographical Analysis</em> 54, 3 (2022),
519–535.</div>
</div>
<div id="ref-boeing2024a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[18]</div><div class="csl-right-inline">G.
Boeing. 2024. Graph simplification solutions to the street intersection
miscount problem.</div>
</div>
<div id="ref-boeing2024b" class="csl-entry" role="listitem">
<div class="csl-left-margin">[19]</div><div class="csl-right-inline">G.
Boeing and J. Ha. 2024. Resilient by design: Simulating street network
disruptions across every urban area in the world. <em>Transportation
Research Part A: Policy and Practice</em> 182, 104016 (2024).</div>
</div>
<div id="ref-bossche2024a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[20]</div><div class="csl-right-inline">J.
Bossche, K. Jordahl, M. Fleischmann, M. Richards, J. McBride, J.
Wasserman, A. G. Badaracco, A. D. Snow, B. Ward, J. Tratner, J. Gerard,
M. Perry, C. Farmer, G. A. Hjelle, and Taves. 2024. Retrieved from <a
target="_blank" rel="noopener" href="https://geopandas/geopandas:%20vo.I4.4.">geopandas/geopandas:
vo.I4.4.</a></div>
</div>
<div id="ref-coutrot2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[21]</div><div class="csl-right-inline">A.
Coutrot, E. Manley, S. Goodroe, C. Gahnstrom, G. Filomena, D. Yesiltepe,
R. C. Dalton, J. M. Wiener, C. Hölscher, M. Hornberger, and H. J.
Spiers. 2022. Entropy of city street networks linked to future spatial
navigation ability. <em>Nature</em> 604, 7904 (2022).</div>
</div>
<div id="ref-crucitti2006a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[22]</div><div class="csl-right-inline">P.
Crucitti, V. Latora, and S. Porta. 2006. Centrality measures in spatial
networks of urban streets. <em>Physical Review E</em> 73, 3
(2006).</div>
</div>
<div id="ref-ducruet2014a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[23]</div><div class="csl-right-inline">C.
Ducruet and L. Beauguitte. 2014. Spatial science and network science:
Review and outcomes of a complex relationship. <em>Networks and Spatial
Economics</em> I4, 3-4 (2014), 297–316.</div>
</div>
<div id="ref-ewing2010a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[24]</div><div class="csl-right-inline">R.
Ewing and R. Cervero. 2010. Travel and the built environment: A
meta-analysis. <em>Journal of the American Planning Association</em> 76,
3 (2010), 265–294.</div>
</div>
<div id="ref-feng2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[25]</div><div class="csl-right-inline">M.
Feng and M. A. Porter. 2020. Spatial applications of topological data
analysis: Cities, snowflakes, random structures, and spiders spinning
under the influence. <em>Physical Review Research</em> 2, 3
(2020).</div>
</div>
<div id="ref-fleischmann2019a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[26]</div><div class="csl-right-inline">M.
Fleischmann. 2019. Momepy: Urban morphology measuring toolkit.
<em>Journal of Open Source Software</em> 4, 43 (2019).</div>
</div>
<div id="ref-foti2014a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[27]</div><div class="csl-right-inline">F.
Foti. 2014. <em>Behavioral framework for measuring walkability and its
impact on home values and residential location choices</em>.
Dissertation, University of California, Berkeley, CA.</div>
</div>
<div id="ref-gaboardi2021a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[28]</div><div class="csl-right-inline">J.
Gaboardi, S. Rey, and S. Lumnitz. 2021. Spaghetti: Spatial network
analysis in PySAL. <em>Journal of Open Source Software</em> 6, 62
(2021).</div>
</div>
<div id="ref-gastner2006a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[29]</div><div class="csl-right-inline">M.
T. Gastner and M. E. J. Newman. 2006. The spatial structure of networks.
<em>The European Physical Journal B: Condensed Matter and Complex
Systems</em> 49, 2 (2006).</div>
</div>
<div id="ref-gervasoni2017a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[30]</div><div class="csl-right-inline">L.
Gervasoni, M. Bosch, S. Fenet, and P. Sturm. 2017. Calculating spatial
urban sprawl indices using open data. In <em>Isth international
conference on computers in urban planning and urban management</em>,
2017. Adelaide, Australia.</div>
</div>
<div id="ref-hagberg2008a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[31]</div><div class="csl-right-inline">A.
A. Hagberg, D. A. Schult, and P. J. Swart. 2008. Exploring network
structure, dynamics, and function using NetworkX. In <em>Proceedings of
the 7 th python in science conference</em>, 2008. Pasadena, CA,
–15.</div>
</div>
<div id="ref-jokar2015a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[32]</div><div class="csl-right-inline">J.
Jokar Arsanjani, A. Zipf, P. Mooney, and M. Helbich (Eds.). 2015.
<em>OpenStreetMap in GIScience</em>. Springer International, Cham,
Switzerland.</div>
</div>
<div id="ref-kedron2021a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[33]</div><div class="csl-right-inline">P.
Kedron, W. Li, S. Fotheringham, and M. Goodchild. 2021. Reproducibility
and replicability: Opportunities and challenges for geospatial research.
<em>International Journal of Geographical Information Science</em> 35, 3
(2021), 427–445.</div>
</div>
<div id="ref-liao2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[34]</div><div class="csl-right-inline">Y.
Liao, J. Gil, R. H. M. Pereira, S. Yeh, and V. Verendel. 2020.
Disparities in travel times between car and transit: Spatiotemporal
patterns in cities. <em>Scientific Reports</em> 10, r (2020).</div>
</div>
<div id="ref-liu2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[35]</div><div class="csl-right-inline">S.
Liu, C. Higgs, J. Arundel, G. Boeing, N. Cerdera, D. Moctezuma, E.
Cerin, D. Adlakha, M. Lowe, and B. Giles-Corti. 2022. A generalized
framework for measuring pedestrian accessibility around the world using
open data. <em>Geographical Analysis</em> 54, 3 (2022), 559–582.</div>
</div>
<div id="ref-lovelace2019a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[36]</div><div class="csl-right-inline">R.
Lovelace and R. Ellison. 2019. Stplanr: A package for transport
planning. <em>The R Journal</em> io(2):7, (2019).</div>
</div>
<div id="ref-marshall2018a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[37]</div><div class="csl-right-inline">S.
Marshall, J. Gil, K. Kropf, M. Tomko, and L. Figueiredo. 2018. Street
network studies: From networks to models and their representations.
<em>Networks and Spatial Economics</em> 18, (2018), 735–749.</div>
</div>
<div id="ref-merch2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[38]</div><div class="csl-right-inline">D.
Merchán, M. Winkenbach, and A. Snoeck. 2020. Quantifying the impact of
urban road networks on the efficiency of local trips. <em>Transportation
Research Part A: Policy and Practice</em> 135, (2020), 38–62.</div>
</div>
<div id="ref-miller1999a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[39]</div><div class="csl-right-inline">H.
J. Miller. 1999. Measuring space-time accessibility benefits within
transportation networks: Basic theory and computational procedures.
<em>Geographical analysis</em> 11 (1999), –26.</div>
</div>
<div id="ref-natera2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[40]</div><div class="csl-right-inline">L.
G. Natera Orozco, F. Battiston, G. Iñiguez, and M. Szell. 2020.
Data-driven strategies for optimal bicycle network growth. <em>Royal
Society Open Science</em> 7, 12 (2020).</div>
</div>
<div id="ref-newman2010a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[41]</div><div class="csl-right-inline">M.
E. J. Newman. 2010. <em>Networks: An introduction</em>. Oxford
University Press, Oxford, England.</div>
</div>
<div id="ref-nilsson2019a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[42]</div><div class="csl-right-inline">L.
Nilsson and J. Gil. 2019. The signature of organic urban growth: Degree
distribution patterns of the city’s street network structure. In <em>The
mathematics of urban morphology</em>, L. D’Acci (ed.). Springer, Cham,
Switzerland, 93–12.</div>
</div>
<div id="ref-osullivan2014a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[43]</div><div class="csl-right-inline">D.
O’Sullivan. 2014. Spatial network analysis. In <em>Handbook of regional
science</em>, M. M. Fischer and P. Nijkamp (eds.). Springer-Verlag,
Berlin, Germany, 1253–1273.</div>
</div>
<div id="ref-porta2006a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[44]</div><div class="csl-right-inline">S.
Porta, P. Crucitti, and V. Latora. 2006. The network analysis of urban
streets: A dual approach. <em>Physica A: Statistical Mechanics and its
Applications</em> 369, 2 (2006).</div>
</div>
<div id="ref-porta2006b" class="csl-entry" role="listitem">
<div class="csl-left-margin">[45]</div><div class="csl-right-inline">S.
Porta, P. Crucitti, and V. Latora. 2006. The network analysis of urban
streets: A primal approach. <em>Environment and Planning B: Planning and
Design</em> 33, 5 (2006), 705–725.</div>
</div>
<div id="ref-ratti2004a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[46]</div><div class="csl-right-inline">C.
Ratti. 2004. Space syntax: Some inconsistencies. <em>Environment and
Planning B: Planning and Design</em> 31, 4 (2004), 487–499.</div>
</div>
<div id="ref-rey2009a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[47]</div><div class="csl-right-inline">S.
J. Rey. 2009. Show me the code: Spatial analysis and open source.
<em>Journal of Geographical Systems</em> 11, 2 (2009), 191–207.</div>
</div>
<div id="ref-rey2019a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[48]</div><div class="csl-right-inline">S.
J. Rey. 2019. PySAL: The first io years. <em>Spatial Economic
Analysis</em> 14, 3 (2019), 273–282.</div>
</div>
<div id="ref-rey2022a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[49]</div><div class="csl-right-inline">S.
J. Rey, L. Anselin, P. Amaral, D. Arribas-Bel, R. X. Cortes, J. D.
Gaboardi, W. Kang, E. Knaap, Z. Li, S. Lumnitz, T. M. Oshan, H. Shao,
and L. J. Wolf. 2022. The PySAL ecosystem: Philosophy and
implementation. Geographical analysis. 54, 3 (2022), 467–487.</div>
</div>
<div id="ref-sasabe2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[50]</div><div class="csl-right-inline">M.
Sasabe, K. Fujii, and S. Kasahara. 2020. Road network risk analysis
considering people flow under ordinary and evacuation situations.
<em>Environment and Planning B: Urban Analytics and City Science</em>
47, 5 (2020), 759–774.</div>
</div>
<div id="ref-singleton2016a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[51]</div><div class="csl-right-inline">A.
D. Singleton, S. Spielman, and C. Brunsdon. 2016. Establishing a
framework for open geographic information science. <em>International
Journal of Geographical Information Science</em> 30, 8 (2016),
1507–1521.</div>
</div>
<div id="ref-tamakloe2021a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[52]</div><div class="csl-right-inline">R.
Tamakloe, J. Hong, J. Tak, and D. Park. 2021. Finding evacuation routes
using traffic and network structure information. <em>Transportation
Research Part D: Transport and Environment</em> 95, 102853 (2021).</div>
</div>
<div id="ref-tinkler1979a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[53]</div><div class="csl-right-inline">K.
J. Tinkler. 1979. Graph theory. <em>Progress in Geography</em> 3, 1
(1979), 85–116.</div>
</div>
<div id="ref-trudeau1994a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[54]</div><div class="csl-right-inline">R.
J. Trudeau. 1994. <em>Introduction to graph theory</em> (and ed.). Dover
Publications, New York, NY.</div>
</div>
<div id="ref-wang2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[55]</div><div class="csl-right-inline">M.
Wang, Z. Chen, L. Mu, and X. Zhang. 2020. Road network structure and
ride-sharing accessibility: A network science perspective.
<em>Computers, Environment and Urban Systems</em> 80, 101430
(2020).</div>
</div>
<div id="ref-yin2020a" class="csl-entry" role="listitem">
<div class="csl-left-margin">[56]</div><div class="csl-right-inline">Y.
Yin, J. Varadarajan, G. Wang, X. Wang, D. Sahrawat, R. Zimmermann, and
S.-K. Ng. 2020. A multi-task learning framework for road attribute
updating via joint analysis of map data and GPS traces. In
<em>Proceedings of the web conference 2020, WWW ’20</em>, 2020.
Association for Computing Machinery, Taipei, Taiwan, 2662–2668,.</div>
</div>
</div>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p> Citation info: Boeing, G. 2024. Modeling and Analyzing
Urban Networks and Amenities with OSMnx. Working paper. <a
target="_blank" rel="noopener" href="https://geoffboeing.com/publications/osmnx-paper/"
class="uri">https://geoffboeing.com/publications/osmnx-paper/</a><a
href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li
id="fn2"><p> 单独的术语连通性在图论中具有独特的定义，但对于空间网络分析来说用处不大，因为近似平面性严格限制了它：几乎所有街道网络的连通性都等于
1。<a href="#fnref2" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p> 本工作论文记录了 OSMnx 2.0.0 正式发布之前的版本<a
href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p> OSMnx 源代码托管在 <a
target="_blank" rel="noopener" href="https://github.com/gboeing/osmnx"
class="uri">https://github.com/gboeing/osmnx</a><a href="#fnref4"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p> OSMnx 文档可在 <a
target="_blank" rel="noopener" href="https://osmnx.readthedocs.io/en/latest/"
class="uri">https://osmnx.readthedocs.io/en/latest/</a>上找到<a
href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p> OSMnx 示例库托管于 <a
target="_blank" rel="noopener" href="https://github.com/gboeing/osmnx-examples"
class="uri">https://github.com/gboeing/osmnx-examples</a><a
href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="http://xishansnow.github.io/vll-pages">Xishansnow</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="http://xishansnow.github.io/vll-pages/posts/746d2025.html">http://xishansnow.github.io/vll-pages/posts/746d2025.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/vll-pages/tags/%E8%BD%AF%E4%BB%B6%E5%B9%B3%E5%8F%B0/">软件平台</a><a class="post-meta__tags" href="/vll-pages/tags/%E5%BC%80%E6%BA%90%E8%BD%AF%E4%BB%B6/">开源软件</a><a class="post-meta__tags" href="/vll-pages/tags/OSMNX/">OSMNX</a></div><div class="post-share"><div class="social-share" data-image="/vll-pages/img/book_19.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/vll-pages/posts/44b0be2e.html" title="无人机交通管理（ UTM ）的分布式多智能体寻路"><img class="cover" src="/vll-pages/img/book_04.png" onerror="onerror=null;src='/vll-pages/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">无人机交通管理（ UTM ）的分布式多智能体寻路</div></div><div class="info-2"><div class="info-item-1">   【摘要】 现实世界中无人机交通管理系统（ UTM ）的开发，以确保无人机 (UAV) 在低空空域的安全集成，最近带来了新的研究挑战。一个关键问题是开发 Pre-flight 冲突检测与消解 (CDR) 方法，以便在所有无人机起飞前为其提供无碰撞飞行路径。此问题可以表示为多智能体路径查找 (MAPF) 问题。目前，大多数 MAPF 方法假设 UTM 系统是一个负责 CDR 的集中实体。但最近关于 UTM 的讨论表明，这种集中控制可能不切实际或不可取。因此，我们探索了 Pre-flight CDR 方法，其中具有自身利益的独立无人机系统服务提供商 (UASSP) 相互通信以解决其无人机运行之间的冲突，而无需集中式的 UTM 调度指令。我们提出了一种支持冲突分布式求解的新型 MAPF...</div></div></div></a><a class="pagination-related" href="/vll-pages/posts/8f2073f9.html" title="大规模无人机配送交通的受限城市空域设计"><img class="cover" src="/vll-pages/img/book_08.png" onerror="onerror=null;src='/vll-pages/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">大规模无人机配送交通的受限城市空域设计</div></div><div class="info-2"><div class="info-item-1">   【摘 要】 在城市地区大规模采用无人机送货服务有望在排放和地面交通拥堵方面带来社会效益，并为无人机物流公司节省成本。但要实现这一点，在城市空域容纳大量无人机交通的能力是最大的挑战之一。对于不受约束的空域，已经证明可以使用交通对齐与分割来减轻冲突概率。当前的研究调查了这些原则在高度受限的空域中的应用。我们提出了两个城市空域概念，通过施加水平结构应用双向和单行道的道路类比。这两个空域概念都采用航向高度规则，根据行进方向垂直分割巡航交通。这些空域配置还具有过渡高度，以适应需要降低飞行速度以便在交叉路口安全转弯的转弯飞行。在使用快速时间仿真实验时，在安全性、稳定性和效率方面比较和评估了这些空域概念在多种交通需求密度下的性能。结果表明，在受限的城市地区构建无人机交通的有效方法是根据行进方向垂直分割高度层，并对交通流量施加水平限制。该研究还为未来研究领域提出了建议，旨在支持动态交通需求模式。 【原 文】 【参考资料】  引言 无人驾驶飞行器（通常称为无人机）的最新进展，在农业、研究、检查、医疗保健、城市空中交通 [16, 18, 23, 27, 40, 41,...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/vll-pages/posts/459f47c7.html" title=" bluesky 仿真器简明教程 "><img class="cover" src="/vll-pages/img/book_17.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-01-05</div><div class="info-item-2"> bluesky 仿真器简明教程 </div></div><div class="info-2"><div class="info-item-1">   【摘 要】 【原 文】 【参考资料】 p{text-indent:2em} bluesky 简明教程 </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-text">引言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%97%E9%81%93%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B%E5%8F%8A%E5%88%86%E6%9E%90"><span class="toc-text">街道网络模型及分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80"><span class="toc-text">模型基础</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%97%E9%81%93%E7%BD%91%E7%BB%9C%E5%88%86%E6%9E%90"><span class="toc-text">街道网络分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A1%97%E9%81%93%E7%BD%91%E7%BB%9C%E5%B7%A5%E5%85%B7%E5%92%8C%E6%95%B0%E6%8D%AE"><span class="toc-text">街道网络工具和数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#osmnx-%E5%8C%85"><span class="toc-text">OSMnx 包</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E7%90%86%E7%BC%96%E7%A0%81%E5%92%8C%E6%9F%A5%E8%AF%A2"><span class="toc-text">地理编码和查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%8E%E5%B8%82%E8%AE%BE%E6%96%BD"><span class="toc-text">城市设施</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%9A%84%E5%BB%BA%E6%A8%A1"><span class="toc-text">网络的建模</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%BE%E6%A8%A1%E5%9E%8B%E7%9A%84%E7%AE%80%E5%8C%96"><span class="toc-text">图模型的简化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BD%AC%E6%8D%A2%E6%8A%95%E5%BD%B1%E5%92%8C%E4%BF%9D%E5%AD%98"><span class="toc-text">转换、投影和保存</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%B7%E6%8B%94"><span class="toc-text">海拔</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%B0%E5%9B%BE%E5%8C%B9%E9%85%8D%E4%B8%8E%E8%B7%AF%E7%BA%BF%E8%A7%84%E5%88%92"><span class="toc-text">地图匹配与路线规划</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%8E%AA%E6%96%BD"><span class="toc-text">网络措施</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-text">可视化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE"><span class="toc-text">安装和配置</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AE%A8%E8%AE%BA"><span class="toc-text">讨论</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%B4%E8%B0%A2"><span class="toc-text">致谢</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Xishansnow</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/vll-pages/js/utils.js"></script><script src="/vll-pages/js/main.js"></script><script src="/vll-pages/js/tw_cn.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (true){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"><script>(() => {
  const loadMathjax = () => {
    if (!window.MathJax) {
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          tags: 'none',
        },
        chtml: {
          scale: 1.1
        },
        options: {
          enableMenu: false,
          renderActions: {
            findScript: [10, doc => {
              for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
                const display = !!node.type.match(/; *mode=display/)
                const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
                const text = document.createTextNode('')
                node.parentNode.replaceChild(text, node)
                math.start = {node: text, delim: '', n: 0}
                math.end = {node: text, delim: '', n: 0}
                doc.math.push(math)
              }
            }, '']
          }
        }
      }
      
      const script = document.createElement('script')
      script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
      script.id = 'MathJax-script'
      script.async = true
      document.head.appendChild(script)
    } else {
      MathJax.startup.document.state(0)
      MathJax.texReset()
      MathJax.typesetPromise()
    }
  }

  btf.addGlobalFn('encrypt', loadMathjax, 'mathjax')
  window.pjax ? loadMathjax() : window.addEventListener('load', loadMathjax)
})()</script><script>(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? '' : ''

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script></div></body></html>